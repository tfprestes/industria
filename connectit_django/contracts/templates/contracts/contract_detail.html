{% extends "base.html" %}

{% block title %}Detalhes do Contrato: {{ contract }} - ConnectIT{% endblock %}

{% block content %}
    <div class="header">
        <h1>Detalhes do Contrato: {{ contract.contract_number|default:contract.id }}</h1>
        <div class="actions">
            <a href="{% url 'contracts:contract_edit' contract.pk %}">Editar</a>
            <a href="{% url 'contracts:contract_delete' contract.pk %}" style="background-color:#e74c3c;">Excluir</a>
        </div>
    </div>

    <h3>Informações Gerais</h3>
    <p><strong>Fornecedor:</strong> {{ contract.supplier.name }}</p>
    <p><strong>Tipo:</strong> {{ contract.contract_type.name }}</p>
    <p><strong>Objeto:</strong> {{ contract.contract_object|linebreaks }}</p>
    <p><strong>Status:</strong> {{ contract.get_status_display }}</p>
    
    <h3>Vigência e Valores</h3>
    <p><strong>Início:</strong> {{ contract.start_date|date:"d/m/Y" }}</p>
    <p><strong>Fim:</strong> {{ contract.end_date|date:"d/m/Y" }} ({{ contract.duration_months }} meses)</p>
    <p><strong>Valor Mensal:</strong> R$ {{ contract.monthly_value }}</p>
    <p><strong>Dia do Pagamento:</strong> Dia {{ contract.payment_day }} de cada mês</p>

    <hr>

    <h3>Pagamentos Agendados</h3>
    <table>
        <thead>
            <tr>
                <th>Vencimento</th>
                <th>Valor</th>
                <th>Status</th>
                <th>Data de Pagamento</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in contract.payments.all %}
            <tr>
                <td>{{ payment.due_date|date:"d/m/Y" }}</td>
                <td>R$ {{ payment.value }}</td>
                <td>{{ payment.get_status_display }}</td>
                <td>{{ payment.payment_date|date:"d/m/Y"|default:"--" }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4">Nenhuma parcela encontrada.</td></tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}